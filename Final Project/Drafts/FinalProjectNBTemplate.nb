(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23488,        533]
NotebookOptionsPosition[     21940,        498]
NotebookOutlinePosition[     22748,        525]
CellTagsIndexPosition[     22705,        522]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["< Project Title >", "Title",
 CellChangeTimes->{{3.770055572438499*^9, 3.7700555729498453`*^9}, {
  3.770055604008165*^9, 
  3.7700556066618843`*^9}},ExpressionUUID->"49ab34ee-bfd5-49f5-beef-\
400d3cc456dd"],

Cell["< First and Last name>", "Text",
 CellChangeTimes->{{3.549624168509506*^9, 3.549624171985794*^9}, {
  3.549624508772977*^9, 3.549624510775043*^9}, {3.5498187159613867`*^9, 
  3.5498187170087957`*^9}, {3.549819049020514*^9, 3.5498190533440437`*^9}, {
  3.77005561844785*^9, 
  3.7700556489651537`*^9}},ExpressionUUID->"94536f76-3fd2-4bf6-b228-\
fa93ec9acae9"],

Cell["< Mentor\[CloseCurlyQuote]s First and Last name>", "Text",
 CellChangeTimes->{{3.549624515773694*^9, 3.5496245246892014`*^9}, {
  3.5498187208956137`*^9, 3.5498187221413403`*^9}, {3.5498190558319674`*^9, 
  3.54981906151682*^9}, {3.770055624686027*^9, 
  3.770055659820487*^9}},ExpressionUUID->"b70c649b-a958-4202-9f22-\
238ea1f9c7d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataParsing", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "RegularExpression", "[", "\"\<^(\\\\-)?\\\\d+(\\\\.)?(\\\\d+)?$\>\"", 
       "]"}], "\[Rule]", "\"\<(interpret) Number\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.+@.+\\\\..+$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Email address\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<(?i)^\\\\s*(?:\\\\+?(\\\\d{1,3}))?[-. (]*(\\\\d{3})[-. \
)]*(\\\\d{3})[-. ]*(\\\\d{4})(?: *x(\\\\d+))?\\\\s*$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Phone\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<(?i)^(https?\\\\:\\\\/\\\\/|www\\\\.).+$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) URL address\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<^$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Empty\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<.+\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Other\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.770893824059902*^9, 3.770893871817873*^9}, 
   3.770895139635758*^9, {3.7709046589596157`*^9, 3.770904659549286*^9}, {
   3.770907533935253*^9, 3.770907534343701*^9}, 3.770907853271167*^9, 
   3.770916744661894*^9, {3.770917785740967*^9, 3.770917786084804*^9}, {
   3.770930170654791*^9, 3.77093018398342*^9}, {3.770984102639523*^9, 
   3.7709841029697847`*^9}, {3.770989075641919*^9, 3.770989077012838*^9}, {
   3.770996267175179*^9, 3.7709963046126328`*^9}, {3.770996334927438*^9, 
   3.770996338875618*^9}, {3.771064263333765*^9, 3.7710643033275127`*^9}, {
   3.771066082292563*^9, 3.771066083447034*^9}, 3.77106638431888*^9, {
   3.771066502189496*^9, 3.7710665207330627`*^9}, {3.771083248515725*^9, 
   3.771083249138871*^9}, {3.771083595938196*^9, 3.771083596339411*^9}, {
   3.771087420341053*^9, 3.7710874745572042`*^9}, {3.7711521028185883`*^9, 
   3.7711521030657473`*^9}},ExpressionUUID->"36b1d01f-c9a7-4696-94e9-\
f6f5acecf4ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headParsing", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Real", "\[Rule]", "\"\<(interpret) Number\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.+@.+\\\\..+$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Email address\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<(?i)^\\\\s*(?:\\\\+?(\\\\d{1,3}))?[-. (]*(\\\\d{3})[-. \
)]*(\\\\d{3})[-. ]*(\\\\d{4})(?: *x(\\\\d+))?\\\\s*$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Phone\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<(?i)^(https?\\\\:\\\\/\\\\/|www\\\\.).+$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) URL address\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<^$\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Empty\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<.+\>\"", "]"}], "\[Rule]", 
      "\"\<(interpret) Other\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771154221501235*^9, 
  3.7711542338885098`*^9}},ExpressionUUID->"c0bef14a-a984-4f82-b564-\
17072649abeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Find", " ", "the", " ", "header"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "parse", " ", "the", " ", "data", " ", "and", " ", "classify", " ", "them",
     " ", "to", " ", "categories"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"parser", "[", "elem_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"head", "=", 
        RowBox[{"Head", "[", "elem", "]"}]}], "}"}], ",", "\n", "\t", 
      RowBox[{"Switch", "[", "\n", "\t\t", 
       RowBox[{"head", ",", "\n", "\t\t", "String", ",", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"elem", ",", "dataParsing"}], "]"}], ",", "\n", "\t\t", "_", 
        ",", " ", 
        RowBox[{"ToString", "[", "head", "]"}]}], "\n", "\t", "]"}]}], "\n", 
     "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findHeader", "[", "file_List", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "columns", ",", " ", "interpretColumn", ",", " ", "bodyCommon", ",", 
        " ", "goodTypes", ",", " ", "firstGoodRow", ",", " ", "header", ",", 
        " ", "headPart", ",", " ", "bodyPart"}], "}"}], ",", "\n", "\t", "\n",
       "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "take", " ", "part", " ", "of", " ", "imported", " ", "file"}], ",", 
        " ", 
        RowBox[{"transpose", " ", "to", " ", "column", " ", "form"}]}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"columns", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"file", ",", " ", 
           RowBox[{"UpTo", "[", "100", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "parse", " ", "selected", " ", "columns", " ", "from", " ", "above", 
         " ", "and", " ", "classify", " ", "them", " ", "to", " ", 
         "categories"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"interpretColumn", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"parser", ",", "columns", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"old", " ", "staff"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"columns", " ", "=", " ", 
          RowBox[{
           RowBox[{"StringReplace", "[", "dataParsing", "]"}], " ", "/@", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"file", ",", " ", 
                RowBox[{"UpTo", "[", "100", "]"}]}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], " ", "*)"}], "\n", 
       "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "the", " ", "most", " ", "common", " ", "data", " ", 
         "type", " ", "in", " ", "each", " ", "column"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"bodyCommon", " ", "=", " ", 
        RowBox[{"Normal", "@@@", 
         RowBox[{"Commonest", "/@", "interpretColumn"}]}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "try", " ", "to", " ", "find", " ", "the", " ", "header", " ", 
         "cells"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "the", " ", "position", " ", "of", " ", "all", " ", 
         "the", " ", "data"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"goodTypes", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"bodyCommon", ",", " ", 
          RowBox[{"Except", "[", 
           RowBox[{
           "\"\<(interpret) Other\>\"", "|", "\"\<(interpret) Empty\>\""}], 
           "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"firstGoodRow", " ", "=", " ", 
        RowBox[{"DeleteMissing", "[", "\n", "\t\t", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"Alternatives", "@@", "goodTypes"}], "]"}], "/@", 
           "interpretColumn"}], "]"}], "\n", "\t", "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"header", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{
          RowBox[{"Commonest", "[", "firstGoodRow", "]"}], ",", " ", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"headPart", " ", "=", " ", 
        RowBox[{"file", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"header", "-", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"bodyPart", " ", "=", " ", 
        RowBox[{"file", "[", 
         RowBox[{"[", 
          RowBox[{"header", ";;"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Header part ends at line \>\"", ",", " ", 
         RowBox[{"header", "-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Body part starts at line \>\"", ",", " ", "header"}], 
        "]"}]}]}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"headPart", ",", "bodyPart", ",", "bodyCommon"}], "}"}], 
       "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.770997854389613*^9, 3.770997878251295*^9}, 
   3.770999490025022*^9, {3.771062694622528*^9, 3.77106270479753*^9}, {
   3.7710654212985086`*^9, 3.771065464663496*^9}, {3.771065502322473*^9, 
   3.771065596704383*^9}, {3.771065670693318*^9, 3.771065707981887*^9}, 
   3.7710661018541193`*^9, {3.7710828198909693`*^9, 3.7710829005277863`*^9}, {
   3.771083146131998*^9, 3.771083155135941*^9}, 3.771083197737688*^9, {
   3.771083680677021*^9, 3.7710836905118217`*^9}, {3.7710844588554068`*^9, 
   3.771084458929291*^9}, {3.77108755551696*^9, 3.771087617977298*^9}, {
   3.771090237266389*^9, 3.771090241812179*^9}, {3.771090363434087*^9, 
   3.77109038560574*^9}, {3.771103182498549*^9, 3.771103334570013*^9}, {
   3.771103374956149*^9, 3.771103444328821*^9}, {3.771103608020734*^9, 
   3.771103619568465*^9}, {3.771103750717412*^9, 3.771103762864661*^9}, {
   3.7711038689284477`*^9, 3.7711038708532333`*^9}, 3.771104805151208*^9, 
   3.771104933094432*^9, {3.771104978131982*^9, 3.771104995567025*^9}, {
   3.771105081400487*^9, 3.771105120439994*^9}, {3.771105155504704*^9, 
   3.771105157828425*^9}, {3.771105193113433*^9, 3.7711052140979147`*^9}, {
   3.771105281088031*^9, 3.771105287672524*^9}, {3.771105369204886*^9, 
   3.77110537439007*^9}, {3.771105592360824*^9, 3.771105693674259*^9}, {
   3.771105740945094*^9, 3.7711057453693438`*^9}, {3.771148766120419*^9, 
   3.771148770931128*^9}, {3.771148807797935*^9, 3.771148903021984*^9}, {
   3.771148939906251*^9, 3.7711491125571833`*^9}, {3.771149235038272*^9, 
   3.771149238252734*^9}, {3.7711492683886223`*^9, 3.771149344771311*^9}, {
   3.771149572491967*^9, 3.771149583191568*^9}, {3.771149618518034*^9, 
   3.7711496253449507`*^9}, {3.7711499566347513`*^9, 3.771149994221084*^9}, 
   3.771150230606669*^9, 3.771150914961742*^9, {3.771151306414042*^9, 
   3.771151307984577*^9}, {3.771151368859601*^9, 3.771151370431068*^9}, {
   3.7711554652432737`*^9, 3.771155472989245*^9}, {3.7711555524850883`*^9, 
   3.7711556302318172`*^9}, {3.771155698569474*^9, 3.7711557139349947`*^9}, {
   3.771155777823786*^9, 3.771155782876068*^9}, {3.771155828215029*^9, 
   3.77115586992143*^9}, {3.771156042616765*^9, 3.771156044888229*^9}, {
   3.7711561850978727`*^9, 3.771156198219164*^9}, {3.771156308963084*^9, 
   3.771156372451734*^9}, {3.771156410422929*^9, 
   3.7711564505580397`*^9}},ExpressionUUID->"508d6289-ca04-4680-bf55-\
cec08b5171ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headParsing", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*year.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Year\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*city.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) City\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*country.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Country\>\""}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*state.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) State\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*zip.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Zip\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"RegularExpression", "[", "\"\<(?i)^.*street.*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Street address\>\""}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*latitude.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Latitude\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*longitude.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Longitude\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<(?i)^.*date.*$\>\"", "]"}], 
      "\[Rule]", "\"\<(interpret) Date\>\""}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.771066141656083*^9, 3.7710662340597153`*^9}, {
   3.7710663226810427`*^9, 3.771066370560842*^9}, {3.771066537514163*^9, 
   3.7710665407846527`*^9}, {3.771066743472537*^9, 3.771066748194031*^9}, {
   3.771066923614746*^9, 3.7710669361547613`*^9}, {3.771066990811798*^9, 
   3.771067001023859*^9}, {3.771081462513871*^9, 3.771081524735423*^9}, {
   3.7710836507209883`*^9, 3.771083655123701*^9}, {3.771084046172469*^9, 
   3.771084052443284*^9}, {3.7710841320280447`*^9, 3.771084137004127*^9}, 
   3.7710841690358677`*^9, {3.771084226305728*^9, 3.771084277712915*^9}, {
   3.771084994612047*^9, 3.771085071036525*^9}, {3.771087647775362*^9, 
   3.771087649029245*^9}, {3.771088347970825*^9, 3.7710883507640257`*^9}, {
   3.771089010908512*^9, 3.771089019230336*^9}},
 CellLabel->
  "In[1350]:=",ExpressionUUID->"0491f927-ddac-4506-b3f7-9ac46495959a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpret", " ", "each", " ", "column"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"interpretColumn", "[", 
    RowBox[{"head_List", ",", " ", "common_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "joinCell", ",", " ", "replaceCell", ",", " ", "diff", ",", " ", 
       "bodySpecial"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"joinCell", " ", "=", " ", 
       RowBox[{"StringJoin", " ", "/@", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"ToString", ",", " ", 
          RowBox[{"Transpose", "[", "head", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"replaceCell", " ", "=", " ", 
       RowBox[{
        RowBox[{"StringReplace", "[", "headParsing", "]"}], " ", "/@", " ", 
        "joinCell"}]}], ";", "\n", "  ", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Normal", " ", "@@@", " ", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{"replaceCell", " ", "-", " ", "joinCell"}], "]"}], "[", 
         "\"\<NonzeroPositions\>\"", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"bodySpecial", " ", "=", " ", 
       RowBox[{"Normal", " ", "@@@", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"common", ",", " ", 
          RowBox[{"Alternatives", " ", "@@", " ", 
           RowBox[{"Complement", "[", 
            RowBox[{"common", ",", " ", 
             RowBox[{"{", "\"\<(interpret) Other\>\"", "}"}], ",", " ", 
             RowBox[{"{", "\"\<(interpret) Empty\>\"", "}"}], ",", " ", 
             RowBox[{"{", "\"\<(interpret) Number\>\"", "}"}]}], "]"}]}]}], 
         "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Column \>\"", ",", " ", 
          RowBox[{"diff", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\< maybe is \>\"", 
          ",", " ", 
          RowBox[{"replaceCell", "[", 
           RowBox[{"[", 
            RowBox[{"diff", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "diff", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "  ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Column \>\"", ",", " ", 
          RowBox[{"bodySpecial", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\< maybe is \>\"", 
          ",", " ", 
          RowBox[{"common", "[", 
           RowBox[{"[", 
            RowBox[{"bodySpecial", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "bodySpecial", "]"}]}], "}"}]}], "]"}]}]}], 
    "\n", "  ", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7710843604083138`*^9, 3.771084377071445*^9}, {
  3.771084786194368*^9, 3.771084786478363*^9}, {3.771087569578938*^9, 
  3.771087572612958*^9}, {3.771087728786159*^9, 3.771087751002336*^9}, {
  3.771102737173387*^9, 3.771102745330328*^9}},
 CellLabel->
  "In[1293]:=",ExpressionUUID->"ed77d2d9-4726-42c6-a267-2ecd279e61d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpret", " ", "each", " ", "column"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"interpretColumn", "[", 
    RowBox[{"head_List", ",", "common_List"}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "joinCell", ",", "replaceCell", ",", "diff", ",", "bodySpecial"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"joinCell", " ", "=", " ", 
       RowBox[{"StringJoin", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"ToString", ",", 
          RowBox[{"Transpose", "[", "head", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}], ";", "\n", "\t", 
      RowBox[{"replaceCell", " ", "=", " ", 
       RowBox[{
        RowBox[{"StringReplace", "[", "headParsing", "]"}], "/@", 
        "joinCell"}]}], ";", "\n", "\t", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Normal", "@@@", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{"replaceCell", " ", "-", " ", "joinCell"}], "]"}], "[", 
         "\"\<NonzeroPositions\>\"", "]"}]}]}], ";", "\n", "\t", 
      RowBox[{"bodySpecial", " ", "=", 
       RowBox[{"Normal", "@@@", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"common", ",", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{"Complement", "[", 
            RowBox[{"common", ",", 
             RowBox[{"{", "\"\<(interpret) Other\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<(interpret) Empty\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<(interpret) Number\>\"", "}"}]}], "]"}]}]}], 
         "]"}]}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Column \>\"", ",", 
          RowBox[{"diff", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< maybe is \>\"", ",", 
          RowBox[{"replaceCell", "[", 
           RowBox[{"[", 
            RowBox[{"diff", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "diff", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Column \>\"", ",", 
          RowBox[{"bodySpecial", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< maybe is \>\"", ",", 
          RowBox[{"common", "[", 
           RowBox[{"[", 
            RowBox[{"bodySpecial", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "bodySpecial", "]"}]}], "}"}]}], "]"}]}]}], 
    "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.771102713402751*^9, 
  3.771102730486505*^9}},ExpressionUUID->"27938082-7620-4d4f-a3e5-\
727da9443ac8"]
}, Open  ]]
},
WindowSize->{1026, 679},
WindowMargins->{{Automatic, -23}, {Automatic, 0}},
DockedCells->{
  Cell[
   TextData[{
     StyleBox["  WOLFRAM ", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontWeight -> 
      Bold, FontSize -> 40], 
     StyleBox["SUMMER SCHOOL", 
      GrayLevel[1], FontFamily -> "Source Sans Pro", FontSize -> 40], 
     StyleBox[" 2019", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontSize -> 
      40]}], CellFrameMargins -> 10, Background -> 
   RGBColor[0.12, 0.14, 0.15]]},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 213, 4, 98, "Title",ExpressionUUID->"49ab34ee-bfd5-49f5-beef-400d3cc456dd"],
Cell[796, 28, 364, 6, 35, "Text",ExpressionUUID->"94536f76-3fd2-4bf6-b228-fa93ec9acae9"],
Cell[1163, 36, 341, 5, 35, "Text",ExpressionUUID->"b70c649b-a958-4202-9f22-238ea1f9c7d4"],
Cell[1507, 43, 2270, 45, 220, "Input",ExpressionUUID->"36b1d01f-c9a7-4696-94e9-f6f5acecf4ad"],
Cell[3780, 90, 1335, 31, 220, "Input",ExpressionUUID->"c0bef14a-a984-4f82-b564-17072649abeb"],
Cell[5118, 123, 8005, 165, 814, "Code",ExpressionUUID->"508d6289-ca04-4680-bf55-cec08b5171ff"],
Cell[13126, 290, 2587, 50, 241, "Input",ExpressionUUID->"0491f927-ddac-4506-b3f7-9ac46495959a"],
Cell[15716, 342, 3313, 79, 304, "Input",ExpressionUUID->"ed77d2d9-4726-42c6-a267-2ecd279e61d0"],
Cell[19032, 423, 2892, 72, 243, "Code",ExpressionUUID->"27938082-7620-4d4f-a3e5-727da9443ac8"]
}, Open  ]]
}
]
*)

