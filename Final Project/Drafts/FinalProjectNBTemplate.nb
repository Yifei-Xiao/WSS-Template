(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72774,       1599]
NotebookOptionsPosition[     71219,       1564]
NotebookOutlinePosition[     72025,       1591]
CellTagsIndexPosition[     71982,       1588]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["< Project Title >", "Title",
 CellChangeTimes->{{3.770055572438499*^9, 3.7700555729498453`*^9}, {
  3.770055604008165*^9, 
  3.7700556066618843`*^9}},ExpressionUUID->"49ab34ee-bfd5-49f5-beef-\
400d3cc456dd"],

Cell["< First and Last name>", "Text",
 CellChangeTimes->{{3.549624168509506*^9, 3.549624171985794*^9}, {
  3.549624508772977*^9, 3.549624510775043*^9}, {3.5498187159613867`*^9, 
  3.5498187170087957`*^9}, {3.549819049020514*^9, 3.5498190533440437`*^9}, {
  3.77005561844785*^9, 
  3.7700556489651537`*^9}},ExpressionUUID->"94536f76-3fd2-4bf6-b228-\
fa93ec9acae9"],

Cell["< Mentor\[CloseCurlyQuote]s First and Last name>", "Text",
 CellChangeTimes->{{3.549624515773694*^9, 3.5496245246892014`*^9}, {
  3.5498187208956137`*^9, 3.5498187221413403`*^9}, {3.5498190558319674`*^9, 
  3.54981906151682*^9}, {3.770055624686027*^9, 
  3.770055659820487*^9}},ExpressionUUID->"b70c649b-a958-4202-9f22-\
238ea1f9c7d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Parsings", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"dataParser", "=", 
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{
        "RegularExpression", "[", "\"\<^(\\\\-)?\\\\d+(\\\\.)?(\\\\d+)?$\>\"",
          "]"}], "\[Rule]", "\"\<(interpret) Number\>\""}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"RegularExpression", "[", "\"\<(?i)^.+@.+\\\\..+$\>\"", "]"}],
         "\[Rule]", "\"\<(interpret) Email address\>\""}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^\\\\s*(?:\\\\+?(\\\\d{1,3}))?[-. (]*(\\\\d{3})[-. \
)]*(\\\\d{3})[-. ]*(\\\\d{4})(?: *x(\\\\d+))?\\\\s*$\>\"", "]"}], "\n", 
        "\t\t\t\t\t", "\[Rule]", "\"\<(interpret) Phone\>\""}], ",", "\n", 
       "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^(https?\\\\:\\\\/\\\\/|www\\\\.).+$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) URL address\>\""}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"RegularExpression", "[", "\"\<^$\>\"", "]"}], "\[Rule]", 
        "\"\<(interpret) Empty\>\""}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"RegularExpression", "[", "\"\<.+\>\"", "]"}], "\[Rule]", 
        "\"\<(interpret) Other\>\""}]}], "\n", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"headParser", "=", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)year(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Year\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)city(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) City\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)country(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Country\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)state(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) State\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)zip(\\\\b|\\\\_).*$\>\"", "]"}], "\[Rule]", 
        "\"\<(interpret) Zip\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)latitude(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Latitude\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)longitude(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Longitude\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
        "RegularExpression", "[", 
         "\"\<(?i)^.*(\\\\b|\\\\_)date(\\\\b|\\\\_).*$\>\"", "]"}], 
        "\[Rule]", "\"\<(interpret) Date\>\""}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"specialList", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<(interpret) Email address\>\"", ",", " ", 
       "\"\<(interpret) Phone\>\"", ",", " ", "\n", "\t\t\t\t", 
       "\"\<(interpret) URL address\>\"", ",", "\"\<(interpret) Year\>\"", 
       ",", "\n", "\t\t\t\t", "\"\<(interpret) City\>\"", ",", " ", 
       "\"\<(interpret) Country\>\"", ",", "\n", "\t\t\t\t", 
       "\"\<(interpret) State\>\"", ",", "\"\<(interpret) Zip\>\"", ",", "\n",
        "\t\t\t\t", "\"\<(interpret) Latitude\>\"", ",", 
       "\"\<(interpret) Longitude\>\"", ",", "\n", "\t\t\t\t", 
       "\"\<(interpret) Date\>\""}], "\n", "}"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.770893824059902*^9, 3.770893871817873*^9}, 
   3.770895139635758*^9, {3.7709046589596157`*^9, 3.770904659549286*^9}, {
   3.770907533935253*^9, 3.770907534343701*^9}, 3.770907853271167*^9, 
   3.770916744661894*^9, {3.770917785740967*^9, 3.770917786084804*^9}, {
   3.770930170654791*^9, 3.77093018398342*^9}, {3.770984102639523*^9, 
   3.7709841029697847`*^9}, {3.770989075641919*^9, 3.770989077012838*^9}, {
   3.770996267175179*^9, 3.7709963046126328`*^9}, {3.770996334927438*^9, 
   3.770996338875618*^9}, {3.771064263333765*^9, 3.7710643033275127`*^9}, {
   3.771066082292563*^9, 3.771066083447034*^9}, 3.77106638431888*^9, {
   3.771066502189496*^9, 3.7710665207330627`*^9}, {3.771083248515725*^9, 
   3.771083249138871*^9}, {3.771083595938196*^9, 3.771083596339411*^9}, {
   3.771087420341053*^9, 3.7710874745572042`*^9}, {3.7711521028185883`*^9, 
   3.7711521030657473`*^9}, {3.771156832412849*^9, 3.771156840773218*^9}, {
   3.771156907874185*^9, 3.771157037903173*^9}, {3.771171183148324*^9, 
   3.771171183297724*^9}, {3.771176369631094*^9, 3.771176371402487*^9}, {
   3.771176930485298*^9, 3.771176973807097*^9}, {3.7712521253813457`*^9, 
   3.7712521286820087`*^9}, {3.771252220122011*^9, 3.771252229891609*^9}, {
   3.771252289709687*^9, 3.771252290044364*^9}, {3.7712565319229183`*^9, 
   3.7712565703121758`*^9}, {3.7712568985305653`*^9, 3.771256901379912*^9}, {
   3.771259041029545*^9, 3.771259043442831*^9}, {3.771273050933056*^9, 
   3.771273056751824*^9}, {3.771323169487397*^9, 3.771323215121355*^9}, {
   3.7713273887728863`*^9, 3.771327392197198*^9}, {3.771331483046513*^9, 
   3.771331486543951*^9}, {3.771331582058197*^9, 3.771331584076147*^9}, {
   3.771331795644189*^9, 3.7713318149267387`*^9}, {3.7713452099181843`*^9, 
   3.771345233040357*^9}, {3.771351033373549*^9, 3.771351035957493*^9}, {
   3.771363288084218*^9, 3.771363338678097*^9}, {3.771364230845042*^9, 
   3.7713642310129433`*^9}, {3.7714133262549343`*^9, 3.771413329965107*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"36b1d01f-c9a7-4696-94e9-f6f5acecf4ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "parse", " ", "the", " ", "data", " ", "and", " ", "classify", " ", "them",
     " ", "to", " ", "categories"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"parser", "[", "elem_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"head", "=", 
        RowBox[{"Head", "[", "elem", "]"}]}], "}"}], ",", "\n", "\t", 
      RowBox[{"Switch", "[", "\n", "\t\t", 
       RowBox[{"head", ",", "\n", "\t\t", "String", ",", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"elem", ",", "dataParser"}], "]"}], ",", "\n", "\t\t", "_", 
        ",", " ", 
        RowBox[{"ToString", "[", "head", "]"}]}], "\n", "\t", "]"}]}], "\n", 
     "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findHeader", "[", "file_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "columns", ",", " ", "interpretColumn", ",", " ", "bodyType", ",", " ",
         "goodTypes", ",", " ", "firstGoodRow", ",", " ", "header", ",", " ", 
        "headPart", ",", " ", "bodyPart"}], "}"}], ",", "\n", "\t", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Split header and body...\>\"", "]"}], ";", 
       "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "take", " ", "part", " ", "of", " ", "imported", " ", "file"}], ",", 
         " ", 
         RowBox[{"transpose", " ", "to", " ", "column", " ", "form"}]}], " ", 
        "*)"}], "\n", "\t", 
       RowBox[{"columns", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"file", ",", " ", 
           RowBox[{"UpTo", "[", "100", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "parse", " ", "selected", " ", "columns", " ", "from", " ", "above", 
         " ", "and", " ", "classify", " ", "them", " ", "to", " ", 
         "categories"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"interpretColumn", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"parser", ",", "columns", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "the", " ", "most", " ", "common", " ", "data", " ", 
         "type", " ", "in", " ", "each", " ", "column"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"bodyType", " ", "=", " ", 
        RowBox[{"Normal", "@@@", 
         RowBox[{"Commonest", "/@", "interpretColumn"}]}]}], ";", "\n", "\t", 
       "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "get", " ", "rid", " ", "of", " ", "other", " ", "and", " ", "empty",
           " ", "parts"}], ",", " ", 
         RowBox[{
         "find", " ", "the", " ", "first", " ", "row", " ", "which", " ", 
          "has", " ", "good", " ", "type"}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{"goodTypes", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"bodyType", ",", " ", 
          RowBox[{"Except", "[", 
           RowBox[{
           "\"\<(interpret) Other\>\"", "|", "\"\<(interpret) Empty\>\""}], 
           "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"firstGoodRow", " ", "=", " ", 
        RowBox[{"DeleteMissing", "[", "\n", "\t\t", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"Alternatives", "@@", "goodTypes"}], "]"}], "/@", 
           "interpretColumn"}], "]"}], "\n", "\t", "]"}]}], ";", "\n", "\t", 
       "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"find", " ", "the", " ", "header"}], ",", " ", 
         RowBox[{"headPart", " ", "and", " ", "bodyPart"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"header", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{
          RowBox[{"Commonest", "[", "firstGoodRow", "]"}], ",", " ", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"headPart", " ", "=", " ", 
        RowBox[{"file", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"header", "-", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"bodyPart", " ", "=", " ", 
        RowBox[{"file", "[", 
         RowBox[{"[", 
          RowBox[{"header", ";;"}], "]"}], "]"}]}], ";", "\n", "\t", "\n", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"print", " ", "the", " ", "result"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Header part ends at line \>\"", ",", " ", 
         RowBox[{"header", "-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Body part starts at line \>\"", ",", " ", "header"}], 
        "]"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"headPart", ",", " ", "bodyPart", ",", " ", "bodyType"}], 
         "}"}], "]"}], ";"}]}], "\n", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.770997854389613*^9, 3.770997878251295*^9}, 
   3.770999490025022*^9, {3.771062694622528*^9, 3.77106270479753*^9}, {
   3.7710654212985086`*^9, 3.771065464663496*^9}, {3.771065502322473*^9, 
   3.771065596704383*^9}, {3.771065670693318*^9, 3.771065707981887*^9}, 
   3.7710661018541193`*^9, {3.7710828198909693`*^9, 3.7710829005277863`*^9}, {
   3.771083146131998*^9, 3.771083155135941*^9}, 3.771083197737688*^9, {
   3.771083680677021*^9, 3.7710836905118217`*^9}, {3.7710844588554068`*^9, 
   3.771084458929291*^9}, {3.77108755551696*^9, 3.771087617977298*^9}, {
   3.771090237266389*^9, 3.771090241812179*^9}, {3.771090363434087*^9, 
   3.77109038560574*^9}, {3.771103182498549*^9, 3.771103334570013*^9}, {
   3.771103374956149*^9, 3.771103444328821*^9}, {3.771103608020734*^9, 
   3.771103619568465*^9}, {3.771103750717412*^9, 3.771103762864661*^9}, {
   3.7711038689284477`*^9, 3.7711038708532333`*^9}, 3.771104805151208*^9, 
   3.771104933094432*^9, {3.771104978131982*^9, 3.771104995567025*^9}, {
   3.771105081400487*^9, 3.771105120439994*^9}, {3.771105155504704*^9, 
   3.771105157828425*^9}, {3.771105193113433*^9, 3.7711052140979147`*^9}, {
   3.771105281088031*^9, 3.771105287672524*^9}, {3.771105369204886*^9, 
   3.77110537439007*^9}, {3.771105592360824*^9, 3.771105693674259*^9}, {
   3.771105740945094*^9, 3.7711057453693438`*^9}, {3.771148766120419*^9, 
   3.771148770931128*^9}, {3.771148807797935*^9, 3.771148903021984*^9}, {
   3.771148939906251*^9, 3.7711491125571833`*^9}, {3.771149235038272*^9, 
   3.771149238252734*^9}, {3.7711492683886223`*^9, 3.771149344771311*^9}, {
   3.771149572491967*^9, 3.771149583191568*^9}, {3.771149618518034*^9, 
   3.7711496253449507`*^9}, {3.7711499566347513`*^9, 3.771149994221084*^9}, 
   3.771150230606669*^9, 3.771150914961742*^9, {3.771151306414042*^9, 
   3.771151307984577*^9}, {3.771151368859601*^9, 3.771151370431068*^9}, {
   3.7711554652432737`*^9, 3.771155472989245*^9}, {3.7711555524850883`*^9, 
   3.7711556302318172`*^9}, {3.771155698569474*^9, 3.7711557139349947`*^9}, {
   3.771155777823786*^9, 3.771155782876068*^9}, {3.771155828215029*^9, 
   3.77115586992143*^9}, {3.771156042616765*^9, 3.771156044888229*^9}, {
   3.7711561850978727`*^9, 3.771156198219164*^9}, {3.771156308963084*^9, 
   3.771156372451734*^9}, {3.771156410422929*^9, 3.7711564505580397`*^9}, {
   3.7711575691805983`*^9, 3.771157600346744*^9}, {3.771168442008498*^9, 
   3.771168775314054*^9}, {3.771168807210701*^9, 3.7711688866391706`*^9}, {
   3.771168925387988*^9, 3.771169237254002*^9}, {3.77116936523323*^9, 
   3.771169366444684*^9}, {3.771169592379032*^9, 3.7711696058504877`*^9}, {
   3.771169940682191*^9, 3.7711699982939043`*^9}, {3.771170146726369*^9, 
   3.771170209415872*^9}, {3.77117040424887*^9, 3.7711705843895073`*^9}, {
   3.7711706197856207`*^9, 3.771170620038122*^9}, {3.771170652461317*^9, 
   3.771170661218831*^9}, {3.771171154566058*^9, 3.77117115469939*^9}, {
   3.771171196909747*^9, 3.77117124622336*^9}, {3.77117206027807*^9, 
   3.771172087131365*^9}, {3.771173071858019*^9, 3.771173072921113*^9}, 
   3.771173231489388*^9, {3.7711734138121557`*^9, 3.771173440326792*^9}, {
   3.771173703125832*^9, 3.7711737657046547`*^9}, {3.771173901084103*^9, 
   3.771173906541379*^9}, {3.7711745777580338`*^9, 3.771174615658437*^9}, {
   3.771175176742317*^9, 3.7711751989022293`*^9}, {3.771175268267655*^9, 
   3.771175330013216*^9}, {3.771175691646459*^9, 3.771175695501378*^9}, {
   3.7711760093273153`*^9, 3.771176088355908*^9}, {3.771176132660473*^9, 
   3.771176139628004*^9}, {3.771176196432115*^9, 3.771176214644499*^9}, 
   3.771176386180928*^9, {3.7711764335600853`*^9, 3.771176467495945*^9}, {
   3.771176896170887*^9, 3.771176901300745*^9}, {3.771177154643105*^9, 
   3.771177221777507*^9}, {3.7711791504975758`*^9, 3.771179202347534*^9}, {
   3.771192984119718*^9, 3.771193078531353*^9}, {3.7711931178843184`*^9, 
   3.771193118353488*^9}, {3.771193289085369*^9, 3.771193294449991*^9}, {
   3.771193325600812*^9, 3.771193475692646*^9}, {3.771193522208857*^9, 
   3.7711936360916147`*^9}, {3.771193816326638*^9, 3.7711938984457703`*^9}, {
   3.771193944498801*^9, 3.771193944634242*^9}, {3.771194146188352*^9, 
   3.771194156161297*^9}, {3.771194296272171*^9, 3.771194296408333*^9}, {
   3.7711961198422194`*^9, 3.771196288617494*^9}, {3.771196450978298*^9, 
   3.7711964596931057`*^9}, {3.7711968757158422`*^9, 3.771196986533737*^9}, {
   3.771197016975481*^9, 3.771197073024866*^9}, {3.771197176956439*^9, 
   3.771197295697215*^9}, {3.771197464520535*^9, 3.771197475854822*^9}, {
   3.771239385346788*^9, 3.771239454397962*^9}, {3.771239695993373*^9, 
   3.7712396973252697`*^9}, {3.7712400422400618`*^9, 3.771240050790144*^9}, {
   3.771240677954878*^9, 3.771240747860751*^9}, {3.771240780023088*^9, 
   3.771240780186367*^9}, {3.7712414047357597`*^9, 3.771241531195889*^9}, {
   3.771243686372472*^9, 3.771243774833913*^9}, {3.77124381417735*^9, 
   3.771243855210915*^9}, {3.771243886854871*^9, 3.771244131583868*^9}, {
   3.771244207699106*^9, 3.771244238277548*^9}, 3.7712538502197943`*^9, {
   3.771256437131733*^9, 3.771256511453911*^9}, {3.771260346249645*^9, 
   3.771260397590852*^9}, {3.7712604305220537`*^9, 3.771260499008788*^9}, {
   3.771260584412772*^9, 3.771260670734888*^9}, {3.7712607719964657`*^9, 
   3.771260800575245*^9}, 3.771260852034625*^9, {3.771260883921812*^9, 
   3.7712609468194838`*^9}, {3.771261441108755*^9, 3.771261486577395*^9}, {
   3.771270751621892*^9, 3.7712709228930693`*^9}, {3.771270982201161*^9, 
   3.771271005622538*^9}, {3.77127139524317*^9, 3.7712713999123793`*^9}, {
   3.771271437178852*^9, 3.771271441125731*^9}, {3.7712716396791973`*^9, 
   3.771271644126384*^9}, {3.7712718262166777`*^9, 3.771271831726658*^9}, {
   3.771272443998066*^9, 3.771272758569219*^9}, {3.771272801205674*^9, 
   3.771272832663134*^9}, {3.771272875039014*^9, 3.7712728765509367`*^9}, {
   3.771272916010295*^9, 3.7712729415604057`*^9}, {3.771272979971197*^9, 
   3.771272980957693*^9}, 3.7712730360578327`*^9, {3.77127315412886*^9, 
   3.771273170487707*^9}, {3.7713217892527*^9, 3.7713218094494877`*^9}, {
   3.771327115680485*^9, 3.771327192695326*^9}, {3.771327264975194*^9, 
   3.77132737137997*^9}, 3.771327418413536*^9, {3.7713274706145563`*^9, 
   3.771327507637512*^9}, 3.771327585553032*^9, {3.77132807000697*^9, 
   3.771328119065892*^9}, {3.771328153653393*^9, 3.771328155529661*^9}, {
   3.771328187769702*^9, 3.771328205935135*^9}, 3.771328243434765*^9, {
   3.771333118105323*^9, 3.7713333511226463`*^9}, {3.7713416904759274`*^9, 
   3.7713416906810827`*^9}, {3.771342050419466*^9, 3.771342138034359*^9}, {
   3.7713422610214357`*^9, 3.771342300581264*^9}, {3.771342335853059*^9, 
   3.771342360869754*^9}, {3.771342458525908*^9, 3.771342538226438*^9}, {
   3.771342578749619*^9, 3.771342579847415*^9}, {3.771342626737908*^9, 
   3.771342745199588*^9}, {3.771342843901886*^9, 3.7713428769243517`*^9}, {
   3.771342937931197*^9, 3.771342952582621*^9}, {3.77134308708558*^9, 
   3.771343126550541*^9}, {3.7713432001002007`*^9, 3.771343236728299*^9}, {
   3.77134346477745*^9, 3.771343499992959*^9}, {3.77134414390543*^9, 
   3.771344241724742*^9}, {3.771345206592505*^9, 3.771345207353414*^9}, {
   3.7713452503478947`*^9, 3.771345251055282*^9}, {3.7713460312306957`*^9, 
   3.7713460423289757`*^9}, {3.77134666328308*^9, 3.771346677598681*^9}, {
   3.7713467081772747`*^9, 3.77134673119074*^9}, {3.771346766646269*^9, 
   3.7713468769111977`*^9}, {3.7713469189208508`*^9, 
   3.7713469956458273`*^9}, {3.771349289586239*^9, 3.7713493013449173`*^9}, {
   3.7713493319797897`*^9, 3.771349355110861*^9}, {3.771349514319338*^9, 
   3.771349566591579*^9}, {3.771349609074802*^9, 3.77134971215644*^9}, {
   3.7713497733801527`*^9, 3.771349777652824*^9}, 3.7713498216427317`*^9, {
   3.771350014083518*^9, 3.7713500239562693`*^9}, {3.771350157821412*^9, 
   3.77135015881633*^9}, {3.771350217574712*^9, 3.771350227632546*^9}, 
   3.771350263022715*^9, {3.7713502987289*^9, 3.7713503073287773`*^9}, {
   3.7713505056509113`*^9, 3.771350511768209*^9}, {3.7713505680359077`*^9, 
   3.771350596999342*^9}, {3.771350756482336*^9, 3.771350763275836*^9}, {
   3.7713516384268847`*^9, 3.771351645851728*^9}, {3.771351683233982*^9, 
   3.771351701633712*^9}, {3.7713517749376297`*^9, 3.7713518056864557`*^9}, {
   3.771352124179758*^9, 3.7713522506909237`*^9}, {3.7713522927562532`*^9, 
   3.771352345661683*^9}, {3.7713578732139683`*^9, 3.771357877409656*^9}, {
   3.771358350826892*^9, 3.77135837050408*^9}, {3.77135937966943*^9, 
   3.77135938207716*^9}, {3.77135946726029*^9, 3.7713595319493093`*^9}, {
   3.771359577335731*^9, 3.7713595919798737`*^9}, {3.771359816539343*^9, 
   3.771359926737631*^9}, {3.7713599836058607`*^9, 3.77136003554767*^9}, {
   3.771360171657888*^9, 3.7713602882557*^9}, {3.771360321835531*^9, 
   3.771360325672859*^9}, {3.771361665641724*^9, 3.7713616791345053`*^9}, {
   3.771412027508541*^9, 3.771412092838717*^9}, {3.771412147485331*^9, 
   3.771412182831203*^9}, {3.7714122190024347`*^9, 3.7714122205911016`*^9}, {
   3.7714122547219687`*^9, 3.771412336278982*^9}, {3.771412399051668*^9, 
   3.771412461893338*^9}, {3.771412636198627*^9, 3.7714126368361197`*^9}, {
   3.771412683201065*^9, 3.771412720930987*^9}, 3.7714136312955637`*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"508d6289-ca04-4680-bf55-cec08b5171ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"guessBody", "[", 
   RowBox[{
   "headPart_List", ",", " ", "bodyPart_List", ",", " ", "bodyType_List"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "headToString", ",", " ", "headMerge", ",", " ", "headParsing", ",", " ",
       "dataType", ",", " ", "dataSpecialTypePosition", ",", " ", 
      "dataSpecialType"}], "}"}], ",", "\n", "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "merge", " ", "header", " ", "together", " ", "if", " ", "there", " ", 
      "are", " ", "multiple", " ", "headers"}], " ", "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"headToString", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"ToString", ",", 
        RowBox[{"Transpose", "[", "headPart", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"headMerge", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"StringJoin", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
         "headToString"}]}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Second", " ", "parse"}], ",", " ", 
       RowBox[{
       "parse", " ", "the", " ", "header", " ", "to", " ", "detect", " ", 
        "keywords"}]}], " ", "*)"}], "\n", "\t", 
     RowBox[{"headParsing", " ", "=", " ", 
      RowBox[{
       RowBox[{"StringReplace", "[", "headParser", "]"}], "/@", 
       "headMerge"}]}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "combine", " ", "head", " ", "and", " ", "body", " ", "special", " ", 
       "type"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"dataType", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"headParsing", ",", "bodyType"}], "}"}], "]"}]}], ";", "\n", 
     "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "find", " ", "the", " ", "position", " ", "and", " ", "get", " ", 
       "special", " ", "type"}], " ", "*)"}], "\n", "\t", "\n", "\t", 
     RowBox[{"dataSpecialTypePosition", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", "\n", "\t\t", 
        RowBox[{"dataType", ",", "\n", "\t\t", 
         RowBox[{"_List", "?", 
          RowBox[{"(", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"_String", "?", 
             RowBox[{"(", 
              RowBox[{"StringStartsQ", "[", 
               RowBox[{"Alternatives", "@@", "specialList"}], "]"}], ")"}]}], 
            "]"}], ")"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "\n", "\t\t", "]"}]}], ";", "\n", 
     "\t\t", "\n", "\t", 
     RowBox[{"dataSpecialType", " ", "=", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", "specialList"}], "]"}], "&"}], "/@", 
       RowBox[{"dataType", "[", 
        RowBox[{"[", "dataSpecialTypePosition", "]"}], "]"}]}]}], ";", "\n", 
     "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"print", " ", "the", " ", "result"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Column \>\"", ",", 
         RowBox[{"dataSpecialTypePosition", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< maybe is \>\"", ",", " ", 
         RowBox[{
          RowBox[{"dataSpecialType", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
         "\"\<\\nRandom data is \>\"", ",", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "bodyPart", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"dataSpecialTypePosition", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", "5"}], 
          "]"}]}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "dataSpecialTypePosition", "]"}]}], "}"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "dataType", "}"}], "]"}], ";"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.771412075082451*^9, 3.771412103751854*^9}, {
  3.771412731508472*^9, 3.771412732200675*^9}, {3.771413019069311*^9, 
  3.771413302328472*^9}, {3.771413353599451*^9, 3.771413492867948*^9}, {
  3.771413621021749*^9, 3.771413627338073*^9}, {3.771415460699695*^9, 
  3.771415484368325*^9}, {3.771416172279963*^9, 3.7714161744438343`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"c5a222cb-f44c-454d-9415-151e268d20cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Phone", ",", " ", "Email", ",", " ", "URL", ",", " ", 
    RowBox[{"Latitude", "/", "Longitude"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Find", " ", "special", " ", "type", " ", "body", " ", "position", " ", 
     "and", " ", "interpret", " ", "it"}], ",", " ", 
    RowBox[{"if", " ", "fails"}], ",", " ", 
    RowBox[{"return", " ", "to", " ", "original", " ", "data"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"fastInterpret", "[", 
    RowBox[{"bodyPart_List", ",", " ", "dataType_List"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
      "fastBody", ",", "\n", "\t", "phonePosition", ",", " ", "phoneTemp", 
       ",", " ", "phoneResult", ",", "\n", "\t", "emailPosition", ",", " ", 
       "emailTemp", ",", " ", "emailResult", ",", "\n", "\t", "URLPosition", 
       ",", " ", "URLTemp", ",", " ", "URLResult", ",", "\n", "\t", 
       "latiPosition", ",", " ", "longiPosition", ",", " ", "latiTemp", ",", 
       " ", "longiTemp", ",", " ", "latiResult", ",", " ", "longiResult"}], 
      "\n", "\t", "}"}], ",", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "body", " ", "part"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"fastBody", " ", "=", " ", "bodyPart"}], ";", "\n", "\n", "\t", 
      
      RowBox[{"(*", " ", "Phone", " ", "*)"}], "\n", "\t", 
      RowBox[{"phonePosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Phone\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"phonePosition", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting PHONE...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"phoneTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "phonePosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"phoneTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "phonePosition"}], "]"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"phoneResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<PhoneNumber\>\"", "]"}], "/@", 
           "phoneTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"phoneResult", " ", "=", " ", 
          RowBox[{"phoneResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", "phoneResult", "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"fastBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "phonePosition"}], "]"}], "]"}], 
            "=", 
            RowBox[{"phoneResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"fastBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "phonePosition"}], "]"}], "]"}], "=", 
          RowBox[{"phoneResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", "Email", " ", "*)"}], "\n", "\t", 
      RowBox[{"emailPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Email address\>\""}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"emailPosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting EMAIL...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"emailTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "emailPosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"emailTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "emailPosition"}], "]"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"emailResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<EmailAddress\>\"", "]"}], "/@", 
           "emailTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"emailResult", " ", "=", " ", 
          RowBox[{"emailResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"emailResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"fastBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "emailPosition"}], "]"}], "]"}], 
            "=", 
            RowBox[{"emailResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"fastBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "emailPosition"}], "]"}], "]"}], "=", 
          RowBox[{"emailResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"URL", " ", 
        RowBox[{"address", ":", " ", "Fast"}]}], " ", "*)"}], "\n", "\t", 
      RowBox[{"URLPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) URL address\>\""}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"URLPosition", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting URL...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"URLTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "URLPosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"URLTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "URLPosition"}], "]"}], "]"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"URLResult", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"URL", ",", "URLTemp", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"URLResult", " ", "=", " ", 
          RowBox[{"URLResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"URLResult", "//", "Dataset"}], "//", "Transpose"}], "]"}],
          ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"fastBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "URLPosition"}], "]"}], "]"}], "=", 
            
            RowBox[{"URLResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"fastBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "URLPosition"}], "]"}], "]"}], "=", 
          RowBox[{"URLResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Latitude", " ", "and", " ", "longitude"}], " ", "*)"}], "\n", 
      "\t", 
      RowBox[{"latiPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Latitude\>\""}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"longiPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Longitude\>\""}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"latiPosition", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], " ", "&&", " ", 
         RowBox[{"longiPosition", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Interpreting LATI and LOGNI...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"latiTemp", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "bodyPart", "]"}], "[", 
              RowBox[{"[", "latiPosition", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{";;", "10"}]}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
         " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"longiTemp", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "bodyPart", "]"}], "[", 
              RowBox[{"[", "longiPosition", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{";;", "10"}]}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
         " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"latiTemp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "bodyPart", "]"}], "[", 
            RowBox[{"[", "latiPosition", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"longiTemp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "bodyPart", "]"}], "[", 
            RowBox[{"[", "longiPosition", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"latiResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"LatitudeLongitude", "@*", "GeoPosition"}], "/@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"latiTemp", ",", "longiTemp"}], "}"}], "]"}]}], ")"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"longiResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"LatitudeLongitude", "@*", "GeoPosition"}], "/@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"latiTemp", ",", "longiTemp"}], "}"}], "]"}]}], ")"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"latiResult", "//", "Dataset"}], "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"longiResult", "//", "Dataset"}], "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"fastBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "latiPosition"}], "]"}], "]"}], "=", 
            RowBox[{"latiResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"fastBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "longiPosition"}], "]"}], "]"}], 
            "=", 
            RowBox[{"longiResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"fastBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "latiPosition"}], "]"}], "]"}], "=", 
          RowBox[{"latiResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{"fastBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "longiPosition"}], "]"}], "]"}], "=", 
          RowBox[{"longiResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\n", "\t", "]"}], ";", "\n",
       "\t", "\n", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "fastBody", "}"}], "]"}], ";"}]}], "\n", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.77141430328666*^9, 3.771414339685762*^9}, {
   3.771414373765761*^9, 3.771414384102042*^9}, {3.771414425145761*^9, 
   3.771414729713382*^9}, {3.771414767772552*^9, 3.771415091823414*^9}, {
   3.771415240665905*^9, 3.771415310320393*^9}, 3.771416351354334*^9, {
   3.7714163848033333`*^9, 3.771416577762889*^9}, {3.7714168741082487`*^9, 
   3.771416907387898*^9}, {3.771417785180129*^9, 3.771417787044855*^9}, {
   3.7714180754709787`*^9, 3.771418079863102*^9}, {3.771418113673293*^9, 
   3.771418148070772*^9}, {3.771418182804521*^9, 3.771418198856121*^9}, 
   3.7714182531087093`*^9, {3.7714187329687023`*^9, 3.771418764998981*^9}, {
   3.771419107595562*^9, 3.7714191391136637`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"890be9d1-9147-4884-807d-f192c3a5cc20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Year", ",", " ", "Date", ",", " ", "Zip", ",", " ", "City", ",", " ", 
    "State", ",", " ", "Country"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Find", " ", "special", " ", "type", " ", "body", " ", "position", " ", 
     "and", " ", "interpret", " ", "it"}], ",", " ", 
    RowBox[{"if", " ", "fails"}], ",", " ", 
    RowBox[{"return", " ", "to", " ", "original", " ", "data"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"slowInterpret", "[", 
    RowBox[{"bodyPart_List", ",", " ", "dataType_List"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
      "slowBody", ",", "\n", "\t", "yearPosition", ",", " ", "yearTemp", ",", 
       " ", "yearResult", ",", "\n", "\t", "datePosition", ",", " ", 
       "dateTemp", ",", " ", "dateCheck", ",", " ", "dateResult", ",", "\n", 
       "\t", "zipPosition", ",", " ", "zipTemp", ",", " ", "zipResult", ",", 
       "\n", "\t", "cityPosition", ",", " ", "cityTemp", ",", " ", 
       "cityResult", ",", "\n", "\t", "statePosition", ",", " ", "stateTemp", 
       ",", " ", "stateResult", ",", "\n", "\t", "countryPosition", ",", " ", 
       "countryTemp", ",", " ", "countryResult"}], "\n", "\t", "}"}], ",", 
     "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "body", " ", "part"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"slowBody", " ", "=", " ", "bodyPart"}], ";", "\n", "\t", "\n", 
      "\t", 
      RowBox[{"(*", " ", "Year", " ", "*)"}], "\n", "\t", 
      RowBox[{"yearPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Year\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"yearPosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting YEAR...\>\"", "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"yearTemp", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"ToString", ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"bodyPart", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{";;", "10"}], ",", "yearPosition"}], "]"}], "]"}], 
               "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"yearTemp", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"ToString", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "yearPosition"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"yearResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<Date\>\"", "]"}], "/@", 
           "yearTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"yearResult", " ", "=", " ", 
          RowBox[{"yearResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"yearResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "yearPosition"}], "]"}], "]"}], "=", 
            RowBox[{"yearResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "yearPosition"}], "]"}], "]"}], "=", 
          RowBox[{"yearResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", "Date", " ", "*)"}], "\n", "\t", 
      RowBox[{"datePosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Date\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"datePosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting DATE...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"dateTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "datePosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"dateTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "datePosition"}], "]"}], "]"}], "]"}]}], ";",
          "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Need", " ", "to", " ", "try", " ", "DateTime", " ", "and", " ", 
           "Date"}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Check", " ", "the", " ", "result", " ", "column", " ", "by", " ", 
           "column"}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"dateResult", "=", 
          RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", "tmp", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"tmp", "=", 
                 RowBox[{
                  RowBox[{"Interpreter", "[", "\"\<DateTime\>\"", "]"}], "[", 
                  "#", "]"}]}], ";", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"AnyTrue", "[", 
                   RowBox[{"tmp", ",", "FailureQ"}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Interpreter", "[", "\"\<Date\>\"", "]"}], "[", 
                   "#", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "tmp"}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], 
             "&"}], "\n", "\t\t\t\t\t\t", ",", "\n", "\t\t\t\t\t\t", 
            "dateTemp"}], "\n", "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"dateResult", " ", "=", " ", 
          RowBox[{"dateResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"dateResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "datePosition"}], "]"}], "]"}], "=", 
            RowBox[{"dateResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "datePosition"}], "]"}], "]"}], "=", 
          RowBox[{"dateResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Zip", " ", "code"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"zipPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Zip\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zipPosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting ZIP...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"zipTemp", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"ToString", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"bodyPart", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{";;", "10"}], ",", "zipPosition"}], "]"}], "]"}], 
               "]"}], ","}], " ", "*)"}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", 
              " ", 
              RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "zipPosition"}], "]"}], "]"}], "]"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"zipResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<ZIPCode\>\"", "]"}], "/@", 
           "zipTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"zipResult", " ", "=", " ", 
          RowBox[{"zipResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"zipResult", "//", "Dataset"}], "//", "Transpose"}], "]"}],
          ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "zipPosition"}], "]"}], "]"}], "=", 
            
            RowBox[{"zipResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "zipPosition"}], "]"}], "]"}], "=", 
          RowBox[{"zipResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", "City", " ", "*)"}], "\n", "\t", 
      RowBox[{"cityPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) City\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cityPosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting CITY...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"cityTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "cityPosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"cityTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "cityPosition"}], "]"}], "]"}], "]"}]}], ";",
          "\n", "\t\t", 
         RowBox[{"cityResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<City\>\"", "]"}], "/@", 
           "cityTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"cityResult", " ", "=", " ", 
          RowBox[{"cityResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"cityResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "cityPosition"}], "]"}], "]"}], "=", 
            RowBox[{"cityResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "cityPosition"}], "]"}], "]"}], "=", 
          RowBox[{"cityResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", "State", " ", "*)"}], "\n", "\t", 
      RowBox[{"statePosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) State\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"statePosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting STATE...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"stateTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "statePosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"stateTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "statePosition"}], "]"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"stateResult", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "Interpreter", "[", "\"\<AdministrativeDivision\>\"", "]"}], "/@", 
           "stateTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"stateResult", " ", "=", " ", 
          RowBox[{"stateResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"stateResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "statePosition"}], "]"}], "]"}], 
            "=", 
            RowBox[{"stateResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "statePosition"}], "]"}], "]"}], "=", 
          RowBox[{"stateResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", "Country", " ", "*)"}], "\n", "\t", 
      RowBox[{"countryPosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dataType", ",", "\"\<(interpret) Country\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"countryPosition", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Interpreting COUNTRY...\>\"", "]"}], ";", 
         "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"countryTemp", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"bodyPart", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", "10"}], ",", "countryPosition"}], "]"}], "]"}], 
             "]"}]}], ";"}], " ", "*)"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"countryTemp", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"bodyPart", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "countryPosition"}], "]"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"countryResult", " ", "=", " ", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<Country\>\"", "]"}], "/@", 
           "countryTemp"}]}], ";", "\n", "\t\t", 
         RowBox[{"countryResult", " ", "=", " ", 
          RowBox[{"countryResult", "/.", 
           RowBox[{
            RowBox[{"f_", "?", "FailureQ"}], "\[RuleDelayed]", 
            RowBox[{"f", "[", "\"\<Input\>\"", "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"countryResult", "//", "Dataset"}], "//", "Transpose"}], 
          "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Debug", " ", "only"}], " ", "*)"}], "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Take", " ", "only", " ", "first", " ", "10"}], ",", " ", 
           RowBox[{"debug", " ", "only"}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"slowBody", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", "10"}], ",", "countryPosition"}], "]"}], "]"}], 
            "=", 
            RowBox[{"countryResult", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t\t", "*)"}], 
         "\n", "\t\t", "\n", "\t\t", 
         RowBox[{
          RowBox[{"slowBody", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "countryPosition"}], "]"}], "]"}], "=", 
          RowBox[{"countryResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", "\n", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "slowBody", "}"}], "]"}], ";"}]}], "\n", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{
  3.771413502821206*^9, 3.77141455591781*^9, {3.771414605076589*^9, 
   3.7714146055665607`*^9}, {3.771414763735067*^9, 3.771414783242364*^9}, {
   3.7714148760273457`*^9, 3.771414886251266*^9}, {3.771414973341735*^9, 
   3.771415009323105*^9}, {3.771416716766121*^9, 3.771416765321414*^9}, {
   3.771416934010701*^9, 3.7714170509850197`*^9}, {3.771417091015592*^9, 
   3.7714170923640738`*^9}, {3.771417132803376*^9, 3.771417799435732*^9}, 
   3.771418576616826*^9, {3.771418724279999*^9, 3.7714187538346443`*^9}, {
   3.771419115044702*^9, 3.771419148471237*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"6c23c3cf-a478-4e18-af89-3eb61ad0085b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "cleanData", "]"}], " ", "=", " ", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{"\"\<interpretType\>\"", " ", "\[Rule]", " ", "\"\<None\>\""}], 
     "\n", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"cleanData", "[", 
   RowBox[{"OptionsPattern", "[", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "file", ",", " ", "headPart", ",", " ", "bodyPart", ",", " ", "bodyType",
       ",", " ", "dataType", ",", " ", "fastInterpretBody", ",", " ", 
      "slowInterpretBody"}], "}"}], ",", "\n", "\t", "\n", "\t", 
    RowBox[{
     RowBox[{"ClearAll", "[", "\"\<Global*`\>\"", "]"}], ";", "\n", "\t", 
     "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Open", " ", ".", "csv"}], " ", "file"}], " ", "*)"}], "\n", 
     "\t", 
     RowBox[{"file", " ", "=", " ", 
      RowBox[{"Import", "[", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<FileOpen\>\"", ",", "\"\<.csv\>\""}], "]"}], "]"}]}], 
     ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"find", " ", "the", " ", "header", " ", "and", " ", "body"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"headPart", ",", "bodyPart", ",", "bodyType"}], "}"}], " ", 
      "=", " ", 
      RowBox[{"findHeader", "[", "file", "]"}]}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"find", " ", "special", " ", "type", " ", "in", " ", "data"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "dataType", "}"}], " ", "=", " ", 
      RowBox[{"guessBody", "[", 
       RowBox[{"headPart", ",", "bodyPart", ",", "bodyType"}], "]"}]}], ";", 
     "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Different", " ", "interpret", " ", "option"}], " ", "*)"}], 
     "\n", "\t", 
     RowBox[{"Print", "[", "\"\<All done, print final result\>\"", "]"}], ";",
      "\n", "\t", 
     RowBox[{"Switch", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<interpretType\>\"", "]"}], ",", "\n", 
       "\t\t", "\"\<None\>\"", ",", " ", "file", ",", "\n", "\t\t", 
       "\"\<fast\>\"", ",", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "fastInterpretBody", "}"}], " ", "=", " ", 
          RowBox[{"fastInterpret", "[", 
           RowBox[{"bodyPart", ",", " ", "dataType"}], "]"}]}], ";", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"headPart", ",", " ", "fastInterpretBody"}], "]"}], "//", 
          "TableForm"}]}], ")"}], ",", "\n", "\t\t", "\"\<full\>\"", ",", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "fastInterpretBody", "}"}], " ", "=", " ", 
          RowBox[{"fastInterpret", "[", 
           RowBox[{"bodyPart", ",", " ", "dataType"}], "]"}]}], ";", "\n", 
         "\t\t\t\t ", 
         RowBox[{
          RowBox[{"{", "slowInterpretBody", "}"}], " ", "=", " ", 
          RowBox[{"slowInterpret", "[", 
           RowBox[{"fastInterpretBody", ",", " ", "dataType"}], "]"}]}], ";", 
         "\n", "\t\t\t\t ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"headPart", ",", " ", "slowInterpretBody"}], "]"}], "//", 
          "TableForm"}]}], ")"}]}], "\n", "\t\t", "]"}]}]}], "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"fast", " ", "interpret"}], " ", "*)"}], "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "fastInterpretBody", "}"}], " ", "=", " ", 
      RowBox[{"fastInterpret", "[", 
       RowBox[{"bodyPart", ",", " ", "dataType"}], "]"}]}], ";"}], " ", 
    "*)"}], "\n", "\t", "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"slow", " ", "interpret"}], " ", "*)"}], "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "slowInterpretBody", "}"}], " ", "=", " ", 
      RowBox[{"slowInterpret", "[", 
       RowBox[{"fastInterpretBody", ",", " ", "dataType"}], "]"}]}], ";"}], 
    " ", "*)"}], "\n", "\t", "\n", "\t", "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"headPart", ",", " ", "slowInterpretBody"}], "]"}], "//", 
     "TableForm"}], " ", "*)"}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQbZexe2mq5BvHnrX+60B0bNXGzSA669LqIyA6J0H9
P4iWucfGnAak52SWcIJoUf47YJrL0koPRL84J+YIos0+MzeB6MT8c80gWkBb
aRKIPnV56WQQfSGgNCkdSFvXLs4H0bqb4+6A6Pq2mWB6waJypgwgnVcxF0y7
SHZKguhP2VHKIHpPrOsWMO00H0wfmTn/HIh2+O13AUQ/KBO8AqLviUTfBNFB
h9p+g+g/f7eC6Ukbfv0H0XyMdUyZQHrf8vSeAiAdWvmmF0TvWfLGuhRIW/7J
twPRR6oKMqpB7ol0LQLRPza+LgPRJx4+rgLRDP/EGkE0x+vtrSC6o2zBTBC9
aXHKChCdwHBpN4h28rbZC6K/dVYcB9GFp7xPgOizXzUuguhVnPpgGgDkpb4S

  "],
 CellLabel->
  "In[166]:=",ExpressionUUID->"0b86dba0-2c34-4349-b31e-9a16092da0e5"]
}, Open  ]]
},
WindowSize->{1253, 755},
WindowMargins->{{2, Automatic}, {Automatic, 0}},
DockedCells->{
  Cell[
   TextData[{
     StyleBox["  WOLFRAM ", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontWeight -> 
      Bold, FontSize -> 40], 
     StyleBox["SUMMER SCHOOL", 
      GrayLevel[1], FontFamily -> "Source Sans Pro", FontSize -> 40], 
     StyleBox[" 2019", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontSize -> 
      40]}], CellFrameMargins -> 10, Background -> 
   RGBColor[0.12, 0.14, 0.15]]},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 213, 4, 98, "Title",ExpressionUUID->"49ab34ee-bfd5-49f5-beef-400d3cc456dd"],
Cell[796, 28, 364, 6, 35, "Text",ExpressionUUID->"94536f76-3fd2-4bf6-b228-fa93ec9acae9"],
Cell[1163, 36, 341, 5, 35, "Text",ExpressionUUID->"b70c649b-a958-4202-9f22-238ea1f9c7d4"],
Cell[1507, 43, 6101, 124, 585, "Code",ExpressionUUID->"36b1d01f-c9a7-4696-94e9-f6f5acecf4ad"],
Cell[7611, 169, 14632, 249, 814, "Code",ExpressionUUID->"508d6289-ca04-4680-bf55-cec08b5171ff"],
Cell[22246, 420, 4737, 110, 623, "Code",ExpressionUUID->"c5a222cb-f44c-454d-9415-151e268d20cf"],
Cell[26986, 532, 17123, 399, 1820, "Code",ExpressionUUID->"890be9d1-9147-4884-807d-f192c3a5cc20"],
Cell[44112, 933, 22216, 510, 2694, "Code",ExpressionUUID->"6c23c3cf-a478-4e18-af89-3eb61ad0085b"],
Cell[66331, 1445, 4872, 116, 737, "Code",ExpressionUUID->"0b86dba0-2c34-4349-b31e-9a16092da0e5"]
}, Open  ]]
}
]
*)

